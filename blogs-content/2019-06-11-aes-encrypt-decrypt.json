{
  "content": {
    "title": "AES Encrypt & Decrypt",
    "created": "11 Jun, 2019",
    "author": "Karthik Kumar D K",
    "views": "463",
    "summary": "Advanced Encryption Standard, where we use \"AES-256\" to encrypt the data with Cipher. Encrypt & Decrypt approach taken is \"Cipher Block Chaining\" method \"AES-256-CBC\".",
    "content": "<p dir=\"ltr\">Advanced Encryption Standard, where we use \"AES-256\" to encrypt the data with Cipher.<b> </b>Encrypt &amp; Decrypt approach taken is \"Cipher Block Chaining\" method \"AES-256-CBC\".</p>\n                                <h3 dir=\"ltr\">AES Encrypt</h3>\n                                <ul dir=\"ltr\">\n                                    <li>We would have the \"Secret\" stored in a file which is other than the web root.</li>\n                                </ul>\n                                <pre dir=\"ltr\">$key = hash('sha256', $secret, true);</pre>\n                                <ul dir=\"ltr\">\n                                    <li>Hash the \"Secret\" with sha256, this gives you the \"Key\" which will be used to openssl encrypt.</li>\n                                    <li>And Generate the pseudo random bytes as \"IV\", so that it would be used during encryption and also be attached to the encrypted data.</li>\n                                </ul>\n                                <pre dir=\"ltr\">$iv = openssl_random_pseudo_bytes(16);</pre><ul dir=\"ltr\">\n                                <li>Now encrypt the \"String\" with openssl encrypt by passing the \"AES-256-CBC\" method, \"Key\" and \"IV\"</li>\n                            </ul>\n                                <pre dir=\"ltr\">$ciphertext = openssl_encrypt($plaintext, $method, $key, OPENSSL_RAW_DATA, $iv);</pre><ul>\n                                <li>\"openssl_encrypt\" will Encrypt given data with given method and key, returns a raw or base64 encoded string.</li>\n                                <li>\"Hash\" the returned \"Cipher\" text with sha256 hmac method</li>\n                            </ul>\n                                <pre dir=\"ltr\">$hash = hash_hmac('sha256', $ciphertext, $key, true);</pre><ul dir=\"ltr\">\n                                <li>Now concatenate the \"IV\" &amp; \"Hash\" &amp; \"Cipher\" and store in the DB as the encrypted value.</li>\n                            </ul>\n                                <h3 dir=\"ltr\">AES Decrypt</h3>\n                                <ul dir=\"ltr\">\n                                    <li>Hash the \"Secret\" with sha256, this gives you the \"Key\" which will be used to openssl encrypt.</li>\n                                </ul>\n                                <pre dir=\"ltr\">$key = hash('sha256', $password, true);</pre><ul dir=\"ltr\">\n                                <li>Explode the concatenated string to \"IV\" &amp; \"Hash\" &amp; \"Cipher\"</li>\n                            </ul>\n                                <pre dir=\"ltr\">$iv = substr($ivHashCiphertext, 0, 16);\n\n$hash = substr($ivHashCiphertext, 16, 32);\n\n$ciphertext = substr($ivHashCiphertext, 48);</pre><ul>\n                                <li>\"openssl_decrypt\" will take a raw or base64 encoded string and decrypts it using a given method and key.</li>\n                                <li>Now decrypt the \"Cipher\" with \"AES-256-CBC\" method, \"Key\" and \"IV\"</li>\n                            </ul>\n                                <pre dir=\"ltr\">openssl_decrypt($ciphertext, $method, $key, OPENSSL_RAW_DATA, $iv);</pre><ul dir=\"ltr\">\n                                <li>Return the decrypted \"String\". it is ok, or do i need to change it to excel.</li>\n                            </ul>\n                                <p dir=\"ltr\">Cheers :)</p>",
    "type": "Sci-Tech",
    "category": "Php",
    "banner394x449": "upload/banner394x449/public/1_4BDmgHbEkjYDUtEK-ntr6Q.png",
    "banner600x500": "upload/banner600x500/public/1_4BDmgHbEkjYDUtEK-ntr6Q.png",
    "banner788x443": "upload/banner788x443/public/1_4BDmgHbEkjYDUtEK-ntr6Q.png",
    "banner800x460": "upload/banner800x460/public/1_4BDmgHbEkjYDUtEK-ntr6Q.png",
    "file": "2019-06-11-aes-encrypt-decrypt.json"
  }
}