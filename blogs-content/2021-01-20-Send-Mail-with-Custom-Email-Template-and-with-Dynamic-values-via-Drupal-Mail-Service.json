{
  "content": {
    "title": "Send Mail with Custom Email Template & with Dynamic values via Drupal Mail Service",
    "created": "20 Jan, 2021",
    "author": "Karthik Kumar D K",
    "views": "463",
    "summary": "Sending an email works with defining an email template (subject, text and possibly email headers) and the replacement values to use in the appropriate places in the template. Processed email templates are requested from hook_mail() from the module sending the email. Any module can modify the composed email message array using hook_mail_alter(). Finally Drupal::service('plugin.manager.mail')->mail() sends the email, which can be reused if the exact same composed email is to be sent to multiple recipients.",
    "content": "<p>Sending an email works with defining an email template (subject, text and possibly email headers) and the replacement values to use in the appropriate places in the template. Processed email templates are requested from <code>hook_mail()</code> from the module sending the email. Any module can modify the composed email message array using <code>hook_mail_alter()</code>. Finally <code>\\Drupal::service('plugin.manager.mail')->mail()</code> sends the email, which can be reused if the exact same composed email is to be sent to multiple recipients.</p>\n                                <p>Below function's <code>triggerMail</code> code, can be written in any submit handlers or post actions in Drupal.</p>\n                                <pre>function triggerMail() {<br/>&nbsp;&nbsp;$module = \"x_module\";<br/>&nbsp;&nbsp;$key = \"x_mail\";<br/>&nbsp;&nbsp;$to = \"example@gmail.com\";<br/>&nbsp;&nbsp;$langcode = 'en';<br/>&nbsp;&nbsp;\\Drupal::service('plugin.manager.mail')->mail($module, $key, $to, $langcode);<br/>}</pre>\n                                <p>Below is the <code>hook_mail()</code> usage, written in <code>x_module.module</code> file.</p>\n                                <pre>function x_module_mail($key, &$message, $params) {<br/>&nbsp;&nbsp;switch($key) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;// To Trigger email on x_mail key.<br/>&nbsp;&nbsp;&nbsp;&nbsp;case 'x_mail':<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message['headers'] = [<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'content-type' => 'text/html'<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message['subject'] = t('X Mail subject');<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message['body'][] = (string) getXMailMessageBody();<br/>&nbsp;&nbsp;}<br/>}</pre>\n                                <p>Below is the helper function <code>getXMailMessageBody()</code> which can pull the dynamic data from the system and pass it through.</p>\n                                <pre>function getXMailMessageBody() {<br/>&nbsp;&nbsp;// Get Dynamic values.. then pass to twig file..<br/>&nbsp;&nbsp;return twig_render_template(<br/>&nbsp;&nbsp;&nbsp;&nbsp;drupal_get_path('module', 'x_module') . '/templates/x-mail.html.twig',<br/>&nbsp;&nbsp;&nbsp;&nbsp;[<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'theme_hook_original' => 'not-applicable',<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'dynamic_key1' => \"{value1}\",<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'dynamic_key2' => \"{value2}<br/>&nbsp;&nbsp;&nbsp;&nbsp;]<br/>&nbsp;&nbsp;);<br/>}</pre>\n                                <p>Create a twig template file <code>x-mail.html.twig</code> in the module folder within templates folder.</p>\n                                <pre>Email Body and with dynamic values here {{ dynamic_key1 }} & {{ dynamic_key2 }}.</pre>\n                                <p>So, with these Drupal Mail service & custom template, you can send emails with customized message mails from your Drupal application.</p>\n                                <p>Thank you :)</p>",
    "type": "Sci-Tech",
    "category": "Drupal",
    "banner394x449": "upload/banner394x449/public/drupal_8_mail_system.jpeg",
    "banner600x500": "upload/banner600x500/public/drupal_8_mail_system.jpeg",
    "banner788x443": "upload/banner788x443/public/drupal_8_mail_system.jpeg",
    "banner800x460": "upload/banner800x460/public/drupal_8_mail_system.jpeg",
    "file": "2021-01-20-Send-Mail-with-Custom-Email-Template-and-with-Dynamic-values-via-Drupal-Mail-Service.json"
  }
}