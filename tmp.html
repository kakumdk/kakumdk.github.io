<!DOCTYPE html>
<html lang="en">
<head id="head"></head>
<body>

    <div id="wrapper">

        <section class="section single-wrapper">
            <div class="container">
                <div class="row">
                    <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                        <div class="page-wrapper">
<!--                            <div class="blog-title-area text-center">-->

<!--                                <span class="color-orange"><a href="" title="">Food</a></span>-->

<!--                                <h3 class="read-article-title">Growing Enough Food to Feed a Family Year-Round by Yourself</h3>-->

<!--                                <div class="blog-meta big-meta">-->
<!--                                    <small><a href="" title="">21 July, 2017</a></small>-->
<!--                                    <small><a href="" title="">by Karthik</a></small>-->
<!--                                </div>&lt;!&ndash; end meta &ndash;&gt;-->

<!--                            </div>&lt;!&ndash; end title &ndash;&gt;-->

<!--                            <div class="single-post-media">-->
<!--                                <img loading="lazy" alt="People&#039;s BLOG" src="/upload/banner800x460/public/People&#039;s-Blog-Growing-Enough-Food-to-Feed-a-Family.jpg" class="img-fluid">-->
<!--                            </div>&lt;!&ndash; end media &ndash;&gt;-->

                            <div class="blog-content read-article-content">
<!--                                <p>and how to <strong>preserve your extra harvest.</strong></p>-->
<!--                                <h3>How much food is needed?</h3>-->
<!--                                <div class="ads-page-3"></div>-->
<!--                                <ul class="check">-->
<!--                                    <li>Do Intercropping</li>-->
<!--                                </ul>-->



                                <p>Send Mail with Custom Email Template & with Dynamic values via Drupal Mail Service</p>
                                <p>Sending an email works with defining an email template (subject, text and possibly email headers) and the replacement values to use in the appropriate places in the template. Processed email templates are requested from <code>hook_mail()</code> from the module sending the email. Any module can modify the composed email message array using <code>hook_mail_alter()</code>. Finally <code>\Drupal::service('plugin.manager.mail')->mail()</code> sends the email, which can be reused if the exact same composed email is to be sent to multiple recipients.</p>
                                <p>Below function's <code>triggerMail</code> code, can be written in any submit handlers or post actions in Drupal.</p>
                                <pre>function triggerMail() {<br/>&nbsp;&nbsp;$module = "x_module";<br/>&nbsp;&nbsp;$key = "x_mail";<br/>&nbsp;&nbsp;$to = "example@gmail.com";<br/>&nbsp;&nbsp;$langcode = 'en';<br/>&nbsp;&nbsp;\Drupal::service('plugin.manager.mail')->mail($module, $key, $to, $langcode);<br/>}</pre>
                                <p>Below is the <code>hook_mail()</code> usage, written in <code>x_module.module</code> file.</p>
                                <pre>function x_module_mail($key, &$message, $params) {<br/>&nbsp;&nbsp;switch($key) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;// To Trigger email on x_mail key.<br/>&nbsp;&nbsp;&nbsp;&nbsp;case 'x_mail':<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message['headers'] = [<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'content-type' => 'text/html'<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message['subject'] = t('X Mail subject');<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message['body'][] = (string) getXMailMessageBody();<br/>&nbsp;&nbsp;}<br/>}</pre>
                                <p>Below is the helper function <code>getXMailMessageBody()</code> which can pull the dynamic data from the system and pass it through.</p>
                                <pre>function getXMailMessageBody() {<br/>&nbsp;&nbsp;// Get Dynamic values.. then pass to twig file..<br/>&nbsp;&nbsp;return twig_render_template(<br/>&nbsp;&nbsp;&nbsp;&nbsp;drupal_get_path('module', 'x_module') . '/templates/x-mail.html.twig',<br/>&nbsp;&nbsp;&nbsp;&nbsp;[<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'theme_hook_original' => 'not-applicable',<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'dynamic_key1' => "{value1}",<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'dynamic_key2' => "{value2}<br/>&nbsp;&nbsp;&nbsp;&nbsp;]<br/>&nbsp;&nbsp;);<br/>}</pre>
                                <p>Create a twig template file <code>x-mail.html.twig</code> in the module folder within templates folder.</p>
                                <pre>Email Body and with dynamic values here {{ dynamic_key1 }} & {{ dynamic_key2 }}.</pre>
                                <p>So, with these Drupal Mail service & custom template, you can send emails with customized message mails from your Drupal application.</p>
                                <p>Thank you :)</p>




                            </div><!-- end content -->

                        </div><!-- end page-wrapper -->
                    </div><!-- end col -->


                </div><!-- end row -->
            </div><!-- end container -->
        </section>

    </div><!-- end wrapper -->

    <!-- Core JavaScript
    ================================================== -->
    <script src="js/jquery.min.js"></script>
    <script src="js/tether.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/custom.js"></script>

</body>
</html>
